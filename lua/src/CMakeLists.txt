project(liblua)
file(GLOB LIBLUA_H *.h)
aux_source_directory(. LIBLUA_C)
list(REMOVE_ITEM LIBLUA_C ./luac.c ./lua.c)
add_library(liblua SHARED ${LIBLUA_H} ${LIBLUA_C})
target_compile_definitions(liblua PRIVATE LUA_BUILD_AS_DLL)
set_target_properties(liblua PROPERTIES ARCHIVE_OUTPUT_DIRECTORY_RELEASE ../../../xluatest)
set_target_properties(liblua PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ../../../xluatest)
set_target_properties(liblua PROPERTIES ARCHIVE_OUTPUT_DIRECTORY_DEBUG ../../../xluatest)
set_target_properties(liblua PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ../../../xluatest)

project(lua)
set(LUA_C ./lua.c)
add_executable(lua ${LUA_C})
set_target_properties(lua PROPERTIES ARCHIVE_OUTPUT_DIRECTORY_RELEASE ../../../xluatest)
set_target_properties(lua PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ../../../xluatest)
set_target_properties(lua PROPERTIES ARCHIVE_OUTPUT_DIRECTORY_DEBUG ../../../xluatest)
set_target_properties(lua PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ../../../xluatest)
target_link_libraries(lua ../../../xluatest/liblua)
ADD_DEPENDENCIES(lua liblua)
